<h1><%= @post.title %></h1>

<% if @post.comments.any? %>
  <h4>Here are the comments for this post</h4>
  <ul>
    <% @post.comments.each do |comment| %>
      <% if comment.reply_id === 0 %>
        <li>
          <%= comment.text %> |
          <%= link_to "Reply", post_comment_reply_path(@post, comment) %> |
          <%= link_to "Edit", edit_post_comment_path(@post, comment) %> |
          <%= link_to "Delete", post_comment_path(@post, comment),
                                   :data => {:confirm => "Are you sure?",
                                   :method => "delete"} %>
            <ul>
              <% @post.comments.each do |subcomment| %>
                <% if subcomment.reply_id == comment.id %>
                  <li><%= subcomment.author%> | <%= subcomment.text%></li>
                <% end %>
              <% end %>
            </ul>
        </li>
      <% end %>
    <% end %>
  </ul>

<% else %>
  <p>There are no comments on this post yet.</p>
<% end %>
<!-- pass -1 to void comment relationship -->
<p><%= link_to "Add a comment", new_post_comment_path(@post) %></p>
<p><%= link_to "Return to posts", posts_path %></p>

<p><%= link_to "Edit", edit_post_path(@post) %></p>
<p><%= link_to "Delete", post_path(@post),
  :data => {:confirm => "Are you sure?",
            :method => "delete"} %></p>
